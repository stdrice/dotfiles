#!/usr/bin/env bash

wall=""
gtk_path="$HOME/.config/gtk-3.0/settings.ini"

dark="Dark"
light="Light"

rofi_cmd() {
    rofi -p "Select theme" -dmenu
}

select_walls(){
    wall=$(zenity --file-selection --title="Choose wallpaper" --filename="$HOME/" --file-filter="Images (*.png *.jpg *.jpeg *.gif)|*.png *.jpg *.jpeg *.gif")
}

select_theme(){
    echo -e "$dark\n$light" | rofi_cmd
}

select_walls
[ -z "$wall" ] && exit 1
chosen=$(select_theme)
case "$chosen" in
    "$dark")
        sed -i -e "s/gtk-icon-theme-name=.*/gtk-icon-theme-name=Papirus-Dark/g" "$gtk_path"
        ~/.local/bin/gentheme "$wall"
        ;;
    "$light") 
        sed -i -e "s/gtk-icon-theme-name=.*/gtk-icon-theme-name=Papirus-Light/g" "$gtk_path"
        ~/.local/bin/gentheme -l "$wall"
        ;;
esac
exit 0
