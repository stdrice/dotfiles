#!/usr/bin/env bash

# Get weather
# Source: wttr.in

# weather location (space = "+")
# example: "London", "Salt+Lake+City"
weather_location=""

# weather units (default = "?m")
# ?u - USCS (farenheit, mph)
# ?m - metric (celcius, km/h)
# ?M - metric (celcius, m/s)
weather_unit="?m"

weather_status(){
    if ping wttr.in -c 1 &> /dev/null; then
        weather=$(curl -sf "wttr.in/$weather_location?format=%c%t&$weather_unit")
        echo "$weather"
        return 1
    else
        return 0
    fi
}

while true; do
  if weather_status -eq 1; then
    "~/.local/bin/safe-sleep" 60m with-interval 10
  else
    sleep 30
  fi
done
